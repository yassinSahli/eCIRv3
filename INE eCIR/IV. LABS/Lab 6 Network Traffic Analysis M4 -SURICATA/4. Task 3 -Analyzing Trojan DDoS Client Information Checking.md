### Analyze the Provided PCAP Files and Develop Your Own Rules (Level: Intermediate)

Analyze DDoSClient.pcap and Adobe.pcap. Develop rules for complex cases.
### Solution for Task 1

![[Pasted image 20250925221126.png]]
By opening DDoSClient.pcap in Wireshark, the first thing we notice is some curious-looking TCP traffic, containing information such as OS, CPU MHZ, and CPU Architecture.

**Rule 1 Analysis**:

- Protocol: DNS (inspects based on protocol, not port).
- Direction: Outbound from home, to any (includes internal resolvers).
- Message: Informs of rogue DNS query.
- Metadata: Reference, classtype, sid, rev.
```alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DDoS Client Information Checking"; flow:established,to_server; content:"Windows"; nocase; depth:7; content:"MHZ|00 00 00 00 00 00|"; distance:0; nocase; content:"|00 00 00 00 00 00|Win"; distance:0; nocase; classtype:trojan-activity; sid:8; rev:1;)```
