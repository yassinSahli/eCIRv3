
### **Analyze the Provided Suricata Rules and Describe What They Look For**

Analyze these rules and explain their detection logic.

**Rule 1:**

```
alert dns $HOME_NET any -> any any (msg:"TROJAN X Rogue DNS Query Observed" dns_query; content:"searchcdn.gooogle.com"; isdataat:!1,relative; reference:url,threatintelprovider.com/trojanx; classtype:trojan-activity; sid:1; rev:1;)
```
- Uses **dns** protocol keyword → detects DNS traffic regardless of port.
- **dns_query buffer** → inspects the domain name.
- **content** matches `default27061330-a.akamaihd.net`.
- **isdataat:!1,relative** ensures match stops at the end of the domain (`.net`), avoiding false positives.

Rule 2:

```
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN Z malicious SSL Cert"; flow:established,to_client; tls_cert_subject; content:"CN=uniquestring"; classtype:trojan-activity; sid:1; rev:1;)
```
- **tls keyword** → inspects TLS traffic by protocol, not port.
- **Direction** `$EXTERNAL_NET -> $HOME_NET` → inbound TLS cert from outside.
- **flow:established,to_client** → matches active TCP session delivering cert to client.
- **tls_cert_subject buffer** → inspects the certificate’s Common Name (CN).
- **content** → looks for `CN=uniquestring` inside the certificate.
