### Vulnerability Finding: SMB Enumeration & NULL-Session Activity : Reconnaissance Observed

**Capture / Lab File:** ``x.pcap
**Date Identified:** 29/09/2025  
**Analyst:** Mr. Yassine SAHLI

---

## Description

SMB traffic in the capture shows active enumeration attempts (Nmap `smb-enum-users`) and evidence of a successful NULL session attempt against a Windows host. Several SMB responses return non-`STATUS_OK` codes that warrant investigation. The RPC calls following the NULL session checks reveal enumeration calls that produced user lists — consistent with an attacker trying to harvest domain/local account information.

---

## Impact

- **Information Disclosure:** NULL sessions and RPC enumeration can expose user accounts, shared resources, and domain information used for further attacks (credential guessing, targeted phishing, lateral movement).  
- **Privilege escalation pivot:** Knowledge gathered can feed password spraying, targeted brute-force, or lateral access attempts.  
- **Reconnaissance stage:** Strong indicator the host/net is being actively probed for attack pathways.

Overall risk: **Medium–High** depending on exposure and sensitive accounts returned.

---

## Evidence

1. SMB conversation frames showing NULL-session negotiation and subsequent RPC enumeration.  
   ![[Pasted image 20250929103554.png]] ![[Pasted image 20250929103631.png]]

2. Nmap `smb-enum-users` probe sequence and RPC calls returning user lists.  
   ![[Pasted image 20250929103848.png]]

---

## MITRE ATT&CK Mapping

- **Discovery** — **T1087** (Account Discovery)  
- **Credential Access / Discovery** — **T1135** (Network Share Discovery)  
- **Initial Access / Reconnaissance** — **T1595** (Active Scanning)

---

## Recommendation

**Immediate**
- Block the source IP(s) performing SMB enumeration or apply rate-limiting and contain the scanning host(s).  
- Verify if any unauthorized authentication or lateral activity followed the enumeration; if so, escalate containment.

**Remediation**
- Disable or harden anonymous/NULL session support on SMB servers.  
- Apply SMB signing and restrict SMB to required hosts/subnets.  
- Audit shares and ACLs; remove any overly permissive shares.

**Detection / Hardening**
- Create SIEM/IDS rules to alert on NULL session attempts, frequent SMB enum commands, and `smb-enum-users` User-Agent or Nmap fingerprints.  
- Enforce strong password policies, MFA for privileged accounts, and monitor failed/successful SMB auths for brute-force patterns.

---

**Severity:** Medium–High  
**CVSSv3.1 Score (approx):** 6.5 (Medium — reconnaissance enabling later attacks)


---

