# Exploitation Activities on the Network

**Endpoint:** `botsv1`  
**Date Identified:** 03/10/2025  
**Tester:** Mr. Yassine SAHLI

## Description
The investigation focused on identifying **exploitation activities** targeting Wayne Enterprises’ web server (`192.168.250.70`). HTTP POST requests were analyzed as they commonly contain login attempts and credential submissions.  

Two suspicious IPs were investigated: **40.80.148.42** and **23.22.63.114**. The analysis revealed brute-force attempts by **23.22.63.114**, including successful logins, while **40.80.148.42** did not show evidence of exploitation.

## Impact
Exploitation activities demonstrate that the adversary attempted to gain unauthorized access to the target system. Risks include:  

- **Credential compromise:** Reused passwords indicate successful account takeovers.  
- **Unauthorized access:** Attackers can access sensitive resources and perform further reconnaissance or lateral movement.  
- **Operational disruption:** Brute-force attacks can impact server availability and log integrity.

## Evidence

### Step 1: Identify POST Request Sources
Search for POST events targeting `192.168.250.70`:

``SPL> index=botsv1 sourcetype=stream:http dest="192.168.250.70" http_method=POST``

![[Pasted image 20251001162341.png]]  
- `src` field highlights IPs generating the largest number of POST requests.

---

### Step 2: Investigate POST Requests from 40.80.148.42
Filter by source IP `40.80.148.42`:

``SPL> index=botsv1 sourcetype=stream:http dest="192.168.250.70" http_method=POST src="40.80.148.42"``

- `form_data` field contains submitted credentials.  
- Result: No successful exploitation observed from this IP.

---

### Step 3: Investigate POST Requests from 23.22.63.114
Filter by second suspicious host:

``SPL> index=botsv1 sourcetype=stream:http dest="192.168.250.70" http_method=POST src="23.22.63.114"``

![[Pasted image 20251001162720.png]]  
- `23.22.63.114` is performing brute-force attacks against the web server authentication form.

---

### Step 4: Re-verify Brute-Force Activity
Confirm repeated POST attempts using `username` and `passwd` fields:

``SPL> index=botsv1 sourcetype=stream:http dest="192.168.250.70" http_method=POST form_data=_username_passwd* | stats count by src``

![[Pasted image 20251001163207.png]]
- Counts show multiple repeated POST attempts from `23.22.63.114`, confirming brute-force behavior.

---

### Step 5: Analyze Attempted Passwords
Extract and count attempted passwords to determine likely successful compromises:

``SPL> index=botsv1 sourcetype=stream:http form_data=_username_passwd* dest_ip=192.168.250.70 | rex field=form_data "passwd=(?<userpassword>\w+)" | stats count by userpassword | sort - count``

![[Pasted image 20251001163432.png]]  
- Passwords appearing multiple times indicate successful compromise and reuse.

---

### Step 6: Identify Time of Compromise and Targeted URIs
Map when compromises occurred and which URIs were targeted:

``SPL> index=botsv1 sourcetype=stream:http form_data=_username_passwd* dest_ip=192.168.250.70 src=40.80.148.42 | rex field=form_data "passwd=(?<userpassword>\w+)" | search userpassword=* | table _time uri userpassword``

![[Pasted image 20251001163912.png]]  
- Table shows timestamps, URIs accessed, and userpasswords attempted during brute force.

---

### Step 7: Confirm Successful Logins
Isolate specific passwords to confirm successful access:

``SPL> index=botsv1 sourcetype=stream:http | rex field=form_data "passwd=(?<userpassword>\w+)" | search userpassword=batman | table _time userpassword src``

![[Pasted image 20251001163948.png]]  
- Two successful login attempts with password `batman` were identified.

---

### Step 8: Update the Cyber Kill Chain
- Brute-force exploitation and confirmed logins are now part of the **Exploitation phase**.  

![[Pasted image 20251001164018.png]]

---

## MITRE ATT&CK Mapping
- **T1110 – Brute Force**  
  - Repeated login attempts to gain credentials.  
- **T1078 – Valid Accounts**  
  - Successful login using compromised credentials.  
- **T1190 – Exploit Public-Facing Application**  
  - Exploitation of web server authentication endpoints.

## Recommendation

1. **Immediate Mitigation**
   - Block `23.22.63.114` and monitor for additional brute-force attempts.  
   - Force password resets for compromised accounts and require MFA for access.

2. **Detection & Monitoring**
   - Configure Splunk alerts for repeated POST attempts and suspicious `form_data` patterns.  
   - Monitor HTTP POST traffic for unusual activity and high-frequency logins.

3. **Endpoint and Application Hardening**
   - Enforce strong password policies and multi-factor authentication.  
   - Limit login attempts per IP and implement IP reputation/blacklisting to mitigate brute-force attacks.

4. **Threat Hunting**
   - Review logs for lateral movement after credential compromise.  
   - Check for additional exploitation attempts using similar TTPs and search for other accounts that used the same password.

## Severity and CVSS

- **Severity:** High  
- **CVSS v3.1 Vector:** AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H  
- **CVSS Base Score:** 8.6 (High)
