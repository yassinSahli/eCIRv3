# Command & Control (C2) Activities on the Network

**Endpoint:** `botsv1`  
**Date Identified:** 03/10/2025  
**Tester:** Mr. Yassine SAHLI

## Description
The investigation focused on detecting **C&C (Command & Control) related activity** associated with the adversary. By analyzing Splunk `stream:dns` logs and pivoting to HTTP/proxy/web logs, the domain **prankglassinebracket.jumpingcrab.com** was identified as a suspicious endpoint resolving to the known malicious IP **23.22.63.114**.

## Impact
C&C infrastructure enables the attacker to:  

- Maintain remote control over compromised systems.  
- Exfiltrate data and deploy additional payloads.  
- Orchestrate lateral movement and further post-exploitation activity.

## Evidence

### Step 1: Search DNS Answers for Suspicious IP
Identify domains resolving to the known malicious IP:

``SPL> index=botsv1 answer=23.22.63.114 sourcetype=stream:dns | stats values("name{}")``

![[Pasted image 20251002165554.png]]  
- The `name{}` field revealed **prankglassinebracket.jumpingcrab.com** as malicious.

---

### Step 2: Confirm Domain Usage in Web/HTTP Logs
Pivot into HTTP logs to see if the domain was contacted:

``SPL> index=botsv1 sourcetype=stream:http (host="192.168.250.70" OR dest="192.168.250.70") (uri="_prankglassinebracket.jumpingcrab.com_" OR host="prankglassinebracket.jumpingcrab.com")``

- Confirms whether the domain was actively contacted or used in payloads.

---

### Step 3: Correlate DNS Queries with Internal Hosts
Determine which internal hosts queried the malicious domain:

``SPL> index=botsv1 sourcetype=stream:dns name="prankglassinebracket.jumpingcrab.com" | stats count by src dest _time``

- `src` identifies internal resolvers or hosts requesting the domain — pivot for endpoint investigation.

---

### Step 4: Enrich Domain with OSINT & Reputation Checks
Conduct external enrichment for the suspicious domain:

- VirusTotal domain report  
- Passive DNS / PassiveTotal lookups  
- Shodan / Censys scans  
- WHOIS lookup  

![[Pasted image 20251003084558.png]]  
![[Pasted image 20251003085051.png]]  

**Finding:** Recent WHOIS update and use of Afraid.org free DNS indicate suspicious operational behavior. Treat both `jumpingcrab.com` and `prankglassinebracket.jumpingcrab.com` as malicious.

---

### Step 5: Update the Cyber Kill Chain & Produce IoCs
- Add domain(s) under **Command & Control** in the kill chain.  
- Produce IOC list:

**Example IOC entry:**  
- Domain: `prankglassinebracket.jumpingcrab.com`  
- Resolved IP: `23.22.63.114`  
- Evidence: `stream:dns` events, correlated HTTP/Suricata/Proxy logs.

![[Pasted image 20251003083753.png]]

---

## MITRE ATT&CK Mapping
- **T1071.001 – Application Layer Protocol: Web Protocols**  
  - C2 communication via HTTP(S).  
- **T1090 – Proxy / Internal Pivot**  
  - Malicious domain queries from internal hosts indicating potential compromise.  
- **T1566 – Phishing**  
  - Use of typosquatted / phishing-style domains for C2 or payload delivery.

## Recommendation

1. **Immediate Mitigation**
   - Block `prankglassinebracket.jumpingcrab.com` and `jumpingcrab.com` at network perimeter.  
   - Monitor DNS queries for the malicious IP and domains.

2. **Detection & Monitoring**
   - Create Splunk alerts for internal hosts querying suspicious domains.  
   - Correlate with HTTP and proxy logs to detect payload retrieval attempts.

3. **Endpoint & Network Hardening**
   - Investigate endpoints identified as querying the domain for compromise.  
   - Apply security controls to prevent C2 communications.

4. **Threat Hunting**
   - Review historical DNS logs for related domains/IPs.  
   - Use extracted IOCs to search for similar activity across the environment.

## Severity and CVSS

- **Severity:** High  
- **CVSS v3.1 Vector:** AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H  
- **CVSS Base Score:** 9.1 (Critical)
