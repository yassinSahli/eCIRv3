### Vulnerability Finding: TCP Session Hijacking

**Endpoint:** `192.168.1.4` ↔ `192.168.1.2` (Lab Environment)  
**Date Identified:** 26/09/2025  
**Tester:** Mr. Yassine SAHLI  

---

## Description

Analysis of TCP traffic revealed indicators of a **TCP session hijacking attack** in progress. Key observations include:  

- **Spoofing vs. Hijacking:**  
  - **Spoofing:** An attacker impersonates a legitimate client while the original user is still active.  
  - **Hijacking:** The attacker fully takes over the session after the original user is inactive, effectively controlling the communication.  

- **Packet Analysis:**  
  - Packet #15 shows **TCP retransmission** with the same sequence and acknowledgment numbers as packet #11, but the **client MAC address has changed** (different from previous packets for 192.168.1.4).  
  - Packet #16 contains a **D-SACK (Duplicate SACK)**, indicating that the host received duplicate segments with the same sequence number.  
  - SEQ/ACK analysis reveals acknowledgment of packets that were not captured, consistent with **packet injection by an attacker**.  

These behaviors confirm that **duplicate/forged packets** were sent to the victim, which is a hallmark of TCP session hijacking. The attacker injected overlapping sequence numbers, causing the server to acknowledge duplicate data and unknowingly send sensitive session data (e.g., Telnet command output) to the malicious host.  

---

## Impact

- **Confidentiality:** Sensitive session data (e.g., Telnet output) is exposed to the attacker.  
- **Integrity:** The attacker can inject or manipulate commands within the session.  
- **Availability:** Legitimate client is displaced from the session.  
- **Service Exploitation:** Lack of defense mechanisms on the server allows complete hijacking without detection.  

This constitutes a **high risk** incident due to full session takeover and potential sensitive data exposure.  

---

## Evidence

1. **D-SACK indicating duplicate/forged packets**  
![[Pasted image 20250926151447.png]]  
![[Pasted image 20250926150957.png]]  

2. **Server unknowingly sends Telnet output to attacker-controlled host**  
![[Pasted image 20250926161553.png]]  

---

## MITRE ATT&CK Mapping

- **Initial Access / Hijacking**  
  - **T1559.001 – Interception of User Sessions: SSH / Telnet Hijacking**  
- **Impact / Exfiltration**  
  - **T1041 – Exfiltration Over C2 Channel** (if attacker captures sensitive session data)  

---

## Recommendation

**Immediate Response:**  
- Terminate the hijacked session and notify affected users.  
- Capture full pcap and isolate attacker host from the network.  

**Remediation:**  
- Disable insecure protocols such as Telnet; use encrypted alternatives (SSH/TLS).  
- Implement session integrity mechanisms and network-level intrusion detection.  
- Enforce MAC/IP binding on switches to detect unexpected MAC changes for active IPs.  

**Preventive Measures:**  
- Enable D-SACK monitoring to detect duplicate packet injection.  
- Deploy IDS/IPS signatures to detect session hijacking patterns (overlapping sequence numbers, unexpected ACKs).  
- Harden servers to reject duplicated or injected packets.  

**Monitoring:**  
- Continuously monitor active sessions for sequence number anomalies.  
- Alert on MAC changes for established sessions and duplicate ACK/D-SACK events.  

---

**Severity:** High  
**CVSSv3.1 Score:** 8.0 – Full session compromise observed with sensitive data exposure.
