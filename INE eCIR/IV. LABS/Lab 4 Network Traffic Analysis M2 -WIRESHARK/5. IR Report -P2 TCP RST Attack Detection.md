### Vulnerability Finding: TCP RST Injection / Reset Attack

**Endpoint:** `192.168.1.4` ↔ `192.168.1.2` (Lab Environment)  
**Date Identified:** 26/09/2025  
**Tester:** Mr. Yassine SAHLI  

---

## Description

During session analysis a packet with the **RST** flag was observed (packet #12) that abruptly terminated an active TCP connection. Normally a TCP connection is closed gracefully via **FIN / FIN-ACK**. An unsolicited RST can indicate either a legitimate application/stack error or a **malicious TCP RST injection** where an attacker forges a reset to tear down an active session.

Key suspicious indicators observed in the capture:

- Packet sequence shows an unexpected **RST** used to terminate a session instead of a graceful FIN close.  
- The same IP (`192.168.1.4`) appears in both packet (11) and packet (12), but the **source MAC addresses differ** (`...:8d` vs `...:aa`) while referring to the same IP — this suggests **IP→MAC inconsistency** and is consistent with forged packets injected on the network.  
- The red-highlighted packet in the conversation and the surrounding packets indicate abrupt, out‑of‑sequence termination behavior.

These findings are consistent with a **TCP Reset Injection Attack** (RST spoofing) intended to forcibly tear down connections between two legitimate hosts.

---

## Impact

- **Availability:** Active sessions can be terminated, disrupting services (telnet/SSH, application sessions).  
- **Operational disruption:** Repeated or targeted RST injection can cause application failures, data transfer interruption, or failover churn.  
- **Reconnaissance & tampering enabler:** RST injection may be used as part of larger active-man-in-the-middle or session-hijacking campaigns.  

This constitutes a **high risk** when repeated or targeted at critical services.

---

## Evidence

1. **RST observed instead of FIN-based teardown** (Wireshark capture).  
![[Pasted image 20250926144057.png]]

2. **Packet #11 vs Packet #12: differing source MACs for same source IP** (MAC ending `:8d` vs `:aa`).  
![[Pasted image 20250926144609.png]]  
![[Pasted image 20250926144456.png]]

---

## MITRE ATT&CK Mapping

- **Impact**  
  - **T1499 – Endpoint Denial of Service** (session disruption via forged resets)  
- **Execution / Network-based manipulation**  
  - **T1557.003 – Adversary-in-the-Middle: Network Device Manipulation** (contextual overlap when attacker injects on-path packets)  

---

## Recommendation

**Immediate Response:**  
- Capture and preserve full pcap of the incident for forensic analysis.  
- Quarantine or isolate affected hosts if critical services are impacted.  
- Examine ARP tables and switch CAM tables to confirm legitimate MAC↔IP bindings for `192.168.1.4` and `192.168.1.2`.  

**Remediation:**  
- Enable **uRPF (Unicast Reverse Path Forwarding)** on edge and distribution routers to reduce IP spoofing.  
- Harden switches: enable port security, MAC sticky binding, and inspect CAM table anomalies.  
- Implement stateful firewalls/IPS rules to detect suspicious RST rates and RSTs coming from unexpected MAC addresses.  
- Where possible, migrate sensitive clear-text services (e.g., Telnet) to encrypted protocols (SSH/TLS) which mitigate session hijack value.  

**Preventive Measures:**  
- Deploy network IDS/IPS signatures to detect RST injection patterns (RSTs with unexpected sequence/ack values; RSTs from different MAC for same IP).  
- Use logging and SIEM correlation: alert on RST spikes, RST from hosts that have no prior SYN/SYN-ACK handshake, and IP↔MAC inconsistencies.  
- Consider application-layer integrity checks and session protections (reconnect limits, multi-factor for session-sensitive apps).  

**Monitoring:**  
- Alert on: RST packets that do not match established TCP state, duplicate RSTs for the same session, and MAC/IP mismatch events.  
- Regularly audit switch CAM tables vs. DHCP/asset inventory to detect on‑path injection opportunities.

---

**Severity:** High  
**CVSSv3.1 Score:** 7.5 – Active session disruption observed; integrity/availability impact.
