### Vulnerability Finding: Fragment-Based Scan Detection

**Endpoint:** `Lab Hosts`  
**Date Identified:** 25/09/2025  
**Tester:** Mr. Yassine SAHLI  

---

## Description

During packet analysis, fragmented IP packets were detected in which **only partial fragments were sent**, with the zero-offset fragment included. This is a technique used in **stealthy reconnaissance**, where the attacker attempts to elicit **“Fragment reassembly time exceeded” ICMP errors** from target hosts.  

Observed traffic indicates either a **host misconfiguration** or a **stealth scanning attempt**, as legitimate hosts rarely generate incomplete fragmented packets under normal operations.  

---

## Impact

- **Reconnaissance:** Allows attackers to map host responses without establishing full connections.  
- **Firewall/IDS Evasion:** Fragmented packets may bypass simple detection mechanisms.  
- **Potential Exploitation Preparation:** Helps attackers identify open ports and vulnerabilities.  

This is a **medium risk**, potentially enabling further attacks.  

---

## Evidence

1. **Partial IP fragments captured**  
![[Pasted image 20250924164228.png]]  
![[Pasted image 20250924164740.png]]  

2. **ICMP responses indicating fragment reassembly timing**  
- Observed “Fragment reassembly time exceeded” errors returned to scanning host.  

---

## MITRE ATT&CK Mapping

- **Reconnaissance**  
  - **T1595.001 – Active Scanning: Network Scanning**  
- **Defense Evasion**  
  - **T1027 – Obfuscated Files or Information** (in this case, fragmented packets for stealth)  

---

## Recommendation

**Immediate Response:**  
- Capture and analyze additional fragmented traffic.  
- Identify and isolate suspicious source hosts.  

**Remediation:**  
- Configure IDS/IPS to detect fragmented scan patterns.  
- Harden hosts to drop incomplete fragments or log anomalies.  

**Preventive Measures:**  
- Enable network segmentation to limit exposure.  
- Apply monitoring for unusual ICMP messages or fragment-based traffic.  

**Monitoring:**  
- Continuous packet inspection with alerts on fragmented reconnaissance patterns.  
- Integrate logs into SIEM for trend analysis and early threat detection.  

---

**Severity:** Medium  
**CVSSv3.1 Score:** 6.2 – Stealthy reconnaissance with potential for subsequent exploitation.