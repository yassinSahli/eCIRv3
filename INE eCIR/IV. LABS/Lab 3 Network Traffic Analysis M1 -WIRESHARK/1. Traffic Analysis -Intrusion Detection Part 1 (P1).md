Network Access Layer: 
![[Pasted image 20250919110952.png]]

Internet Layer:
![[Pasted image 20250919111032.png]]

Transport Layer:
![[Pasted image 20250919111044.png]]

Application Layer:
![[Pasted image 20250919111053.png]]

Cc: 
![[Pasted image 20250919110930.png]]


# ARP Poisoning Lab / Spoofing Detection Lab

- **ARP** maps IP addresses → MAC addresses on a local network.  
- **Attack:** attacker sends fake ARP replies so your PC links the wrong MAC to an IP (often the gateway).  
- **Impact:** attacker can **intercept, modify, or drop** your traffic (Man-in-the-Middle).  
- **Detect:**  
  - Linux → `ip neigh`  
  - Windows → `arp -a`  
  - Look for gateway IP mapped to a strange MAC.  
- **Defend:**  
  - Use HTTPS / VPN  
  - Enable switch ARP inspection or port security  
  - Use static ARP for key devices  
![[Pasted image 20250924090030.png]]

## Lab File: 
![[Pasted image 20250924145455.png]]

`` Applied Filter: arp
![[Pasted image 20250924092210.png]]
We can actually identify the malicious device's thus the **attacker's IP address** on the network since we know its MAC address, by filtering the traffic looking for frames that hold the attacker’s MAC address. 

As we can see the ARP replies we saw earlier in addition to an ACK segment coming from 
192.168.153.154 which contains the attacker’s MAC address we got earlier.

Right click on the Source MAC Address and Select **Apply as Filter** Then **Selected**
![[Pasted image 20250924092728.png]]
![[Pasted image 20250924093638.png]]


# MAC Flooding Detection Lab

## Lab File: 
![[Pasted image 20250924145119.png]]

![[Pasted image 20250924145421.png]]
Packets don’t belong to the segment where we sniffed traffic (their origin is quite sparse actually). 

![[Pasted image 20250924150244.png]]
-> The trailer log msg indicates that packets are made / crafted by a malicious user: 

We can resort to the same conclusion that this is malicious behaviour using the **statistics** feature: 
(1):
![[Pasted image 20250924151111.png]]

![[Pasted image 20250924151159.png]]

(2):
![[Pasted image 20250924151302.png]]
![[Pasted image 20250924151234.png]]
--> A legitimate device does not typically send just a **single packet** and then immediately disconnect from the network. Such behavior suggests a **probing or reconnaissance attempt**, where the attacker is trying to test connectivity or gather information without establishing a normal communication flow.



# Bad IP Version Detection Lab

## Lab File: 
![[Pasted image 20250924160407.png]]
![[Pasted image 20250924162046.png]]

This time, let’s look at the IPv4 Protocol Number. Depending on this field’s value the protocol/transport layer that follows the IP header is identified. The venerable Nmap network scanner leverages this to perform IP protocol scanning against a given target. This type of scanning is also a stealthier way to identify a live host.

Note: IPV4 Protocol Number = 4 *anything else is considered an NMAP Scan*
![[ip-header.gif]]

(1):
![[Pasted image 20250924162702.png]]
![[Pasted image 20250924162734.png]]

(2):
When ICMP port is filtered using firewalls, attackers tend to modify ICMP port number to bypass the firewall:
![[Pasted image 20250924163135.png]]
![[Pasted image 20250924163429.png]]
This is a common reconnaissance technique: attackers use it to **map which protocols a host supports**
Scenario: 
- `192.168.1.4` is probing `192.168.1.6` using an unassigned IP protocol (164) using the following nmap command:
		# `nmap -sO -Pn 192.168.1.6`
- `192.168.1.6` is alive and answering with ICMP Type 3 Code 2 = “Protocol unreachable.”
- This is **protocol scanning reconnaissance traffic**, often a sign of malicious or suspicious activity.


# Frag Based Scan Detection Lab

## Lab File: 
![[Pasted image 20250924164228.png]]

 A stealthy mapping technique exists that leverages fragmentation. Specifically, the attacker sends an incomplete set of fragments (the zero offset fragment must be included) to the scanned hosts. Of course, the scanned hosts should be listening on the specified port or protocol.
![[Pasted image 20250924164740.png]]

If this is the case, once the first fragment is received, a timer is set. Once this timer expires, the receiving host transmits an ICMP “Fragment reassembly time exceeded” error back to the attacker.

--> We are either dealing with a host misconfiguration or a stealthy scanning attempt! 
# IPV6 Tunneling Packets Detection Lab
## Lab File: 
![[Pasted image 20250924164904.png]]
- This attack hides malicious traffic inside **IPv6 tunneling packets** sent over an IPv4 network to bypass security monitoring.

- Detecting it involves spotting unusual encapsulated IPv6 packets or abnormal tunneling behavior.


Wireshark labels this attack as 'Tredo' so applying the following filters will showcase the attack: 
```
tredo #KEYWORD
udp.port == 3544 #UDP port that is primarily used to allow IPv6 connectivity over IPv4 networks
```

![[Pasted image 20250925083939.png]]
-> that is **Teredo (IPv6-over-UDP) tunneling** hiding IPv6 traffic inside

![[Pasted image 20250925083931.png]]
-> UDP port **3544** traffic to/from hosts that shouldn’t use IPv6.

![[Pasted image 20250925085454.png]]
![[Pasted image 20250925085717.png]]
-> Presence of IPv6 addresses inside IPv4 flows.