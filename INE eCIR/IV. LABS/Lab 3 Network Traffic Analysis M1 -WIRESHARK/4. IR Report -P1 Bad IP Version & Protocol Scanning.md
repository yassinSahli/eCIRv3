
### Vulnerability Finding: Bad IP Version / Protocol Scanning

**Endpoint:** `192.168.1.6` (Lab Environment)  
**Date Identified:** 25/09/2025  
**Tester:** Mr. Yassine SAHLI  

---

## Description

Traffic analysis revealed that host `192.168.1.4` probed `192.168.1.6` using **unassigned IPv4 Protocol Number 164**. This type of traffic is typical of **IP protocol scanning reconnaissance**.  

The target host responded with **ICMP Type 3 Code 2 (“Protocol unreachable”)**, confirming its availability while exposing supported protocol details. Attackers often perform this type of scan to **map live hosts and available protocols stealthily**, bypassing firewall restrictions.  

---

## Impact

- **Reconnaissance:** Attacker can enumerate supported protocols and live hosts.  
- **Preparation for Targeted Attacks:** Information collected may aid subsequent exploitation.  
- **Firewall Evasion:** Modified ICMP/protocol numbers bypass simple filtering.  

This constitutes a **medium risk**, indicating a potential precursor to malicious activity.

---

## Evidence

1. **Suspicious IP protocol number (164) observed in captures**  
![[Pasted image 20250924162702.png]]  
![[Pasted image 20250924162734.png]]  

2. **ICMP Type 3 Code 2 response from target host**  
![[Pasted image 20250924163135.png]]  
![[Pasted image 20250924163429.png]]  

---

## MITRE ATT&CK Mapping

- **Reconnaissance**  
  - **T1595.001 – Active Scanning: IP Protocol Scanning**  
- **Discovery**  
  - **T1046 – Network Service Scanning**  

---

## Recommendation

**Immediate Response:**  
- Log and alert on unusual protocol numbers reaching critical hosts.  
- Monitor for repeated scanning behavior from the source IP.  

**Remediation:**  
- Configure firewall to drop packets with undefined or suspicious protocol numbers.  
- Implement rate-limiting and anomaly detection for ICMP traffic.  

**Preventive Measures:**  
- Segment sensitive networks to reduce exposure to scanning.  
- Employ network IDS/IPS rules to detect protocol scanning reconnaissance.  

**Monitoring:**  
- Capture and analyze all unusual IP protocol traffic.  
- Integrate protocol anomaly alerts into SIEM dashboards.  

---

**Severity:** Medium  
**CVSSv3.1 Score:** 6.0 – Reconnaissance activity, no direct exploitation yet.  
