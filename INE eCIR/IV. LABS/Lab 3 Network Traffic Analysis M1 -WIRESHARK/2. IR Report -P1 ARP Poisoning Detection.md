### Vulnerability Finding: 

**Endpoint:** `192.168.153.148` (Lab Environment)  
**Date Identified:** 25/09/2025  
**Tester:** Mr. Yassine SAHLI  

---

## Description

During traffic inspection at the network access layer, multiple unsolicited ARP replies were detected on the subnet. These ARP responses originated from a host attempting to **map its own MAC address to the default gateway IP**, thereby misleading other devices into routing their traffic through the attacker.  

Further analysis of the capture revealed that the attacker’s MAC address was consistently present in both ARP replies and TCP acknowledgment segments originating from IP `192.168.153.154`. This confirmed the presence of an **active ARP spoofing attack** within the environment.  

The attacker leveraged this technique to position themselves as a **Man-in-the-Middle (MITM)**, capable of intercepting, modifying, or dropping traffic between legitimate hosts.

---

## Impact

- **Traffic Interception:** Attacker can eavesdrop on sensitive communications (credentials, sessions).  
- **Traffic Manipulation:** MITM position enables injection, alteration, or replay of packets.  
- **Denial of Service:** Spoofed ARP entries can disrupt routing, causing communication failures.  
- **Stealthy Reconnaissance:** Allows attackers to silently monitor network traffic for further exploitation.  

This is a **critical risk**, as it undermines the fundamental trust of ARP at the network layer.

---

## Evidence

1. **Unsolicited ARP replies** binding the gateway IP to an attacker-controlled MAC address.  
![[Pasted image 20250924092210.png]]

2. **Suspicious ACK segment** originating from `192.168.153.154` carrying the attacker’s MAC address.  
![[Pasted image 20250924092728.png]]

---

## MITRE ATT&CK Mapping

- **Credential Access**  
  - **T1557.002 – Adversary-in-the-Middle: ARP Cache Poisoning**: Manipulating ARP tables to intercept network communications.  
- **Discovery**  
  - **T1040 – Network Sniffing**: Capturing traffic passing through compromised ARP mappings.  

---

## Recommendation

**Immediate Response:**  
- Identify and isolate the malicious host (`192.168.153.154`).  
- Flush and refresh ARP caches on affected devices.  
- Reset active sessions and credentials potentially exposed during the attack.  

**Remediation:**  
- Enforce static ARP entries on critical systems (e.g., gateways, servers).  
- Configure network switches with **Dynamic ARP Inspection (DAI)** and **port security**.  
- Deploy IDS/IPS rules to monitor and block spoofed ARP traffic.  

**Preventive Measures:**  
- Use encrypted protocols (HTTPS, SSH, VPN) to minimize cleartext exposure.  
- Regularly audit ARP tables for anomalies (`arp -a`, `ip neigh`).  
- Segment critical networks to reduce attack surface.  

**Monitoring:**  
- Enable continuous ARP monitoring with alerts on duplicate or unexpected MAC-to-IP mappings.  
- Integrate SIEM alerts for repeated unsolicited ARP replies.  
- Capture and analyze traffic regularly to detect MITM patterns early.  

---

**Severity:** Critical  
**CVSSv3.1 Score:** 9.1 (Critical – Active MITM with potential credential theft and traffic manipulation)


