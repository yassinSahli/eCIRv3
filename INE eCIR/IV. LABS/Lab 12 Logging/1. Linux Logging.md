
# üêß Linux Event Logging

## Overview
Linux event logging is the process of recording system, application, and security-related events for monitoring, troubleshooting, and auditing purposes.  
All logs are usually stored in plain text files located in `/var/log`.

---

## Main Log Locations

| Directory / File | Description |
|------------------|-------------|
| `/var/log/syslog` | General system messages (Debian/Ubuntu) |
| `/var/log/messages` | General system messages (RHEL/CentOS/Fedora) |
| `/var/log/auth.log` | Authentication and authorization logs |
| `/var/log/secure` | Security logs (login attempts, sudo, etc.) |
| `/var/log/kern.log` | Kernel logs |
| `/var/log/dmesg` | Boot and kernel ring buffer messages |
| `/var/log/cron` | Cron job execution logs |
| `/var/log/httpd/` | Apache web server logs |
| `/var/log/audit/audit.log` | SELinux and auditd security events |

---

## Logging Architecture

### 1. **rsyslog**
- Default syslog daemon on most Linux systems.
- Handles message reception, filtering, and storage.
- Configuration file: `/etc/rsyslog.conf`
- Supports remote logging:
  ```bash
  *.* @@logserver.example.com:514
```
### 2. **systemd-journald**

- Collects logs from kernel, initrd, services, and syslog.
    
- Stores logs in binary format: `/var/log/journal/`
    
- Commands:
```
journalctl              # View all logs
journalctl -u ssh       # Logs for a specific unit
journalctl --since "2025-10-13 10:00"  # Filter by time
```

### 3. **auditd**

- Auditing daemon for tracking security-relevant events.
    
- Config file: `/etc/audit/auditd.conf`
    
- Rules file: `/etc/audit/rules.d/audit.rules`
    
- Useful commands:
```
auditctl -l             # List current audit rules
ausearch -m USER_LOGIN  # Search for login events
aureport -au            # Generate authentication report
```

## Log Management Tools

|Tool|Purpose|
|---|---|
|**logrotate**|Automatically rotates, compresses, and deletes old logs. Config: `/etc/logrotate.conf`|
|**journalctl**|Query and view systemd logs|
|**ausearch / aureport**|Analyze audit logs|
|**rsyslog**|Manage and forward syslog messages|
|**dmesg**|View kernel ring buffer messages|

## Common Commands

 ```
# View last 50 system log entries
tail -n 50 /var/log/syslog

# Follow live updates
tail -f /var/log/messages

# Check failed login attempts
grep "Failed password" /var/log/auth.log

# Filter logs by date and time
journalctl --since "2025-10-13" --until "2025-10-14"

# Analyze audit events
ausearch -x /usr/bin/sudo
 ```
 

![[Pasted image 20251013133045.png]]

![[Pasted image 20251013133102.png]]

![[Pasted image 20251013133154.png]]

![[Pasted image 20251013133120.png]]

![[Pasted image 20251013133140.png]]