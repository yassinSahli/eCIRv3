# ðŸªŸ Windows Event Viewer & Security Policy

## Overview
Windows Event Viewer is a centralized tool used to view, analyze, and manage system, application, and security event logs.  
It provides critical visibility into the operating systemâ€™s activity, enabling troubleshooting, auditing, and security monitoring.

---

## Event Log Categories

| Log Type | Description | Common Location |
|-----------|--------------|------------------|
| **Application** | Logs from user-level applications and services | Event Viewer â†’ Windows Logs â†’ Application |
| **System** | Logs from Windows system components (drivers, services) | Event Viewer â†’ Windows Logs â†’ System |
| **Security** | Records security-related events (logons, privilege use, policy changes) | Event Viewer â†’ Windows Logs â†’ Security |
| **Setup** | Installation and setup logs for Windows | Event Viewer â†’ Windows Logs â†’ Setup |
| **Forwarded Events** | Logs collected from remote systems | Event Viewer â†’ Windows Logs â†’ Forwarded Events |

---

## Event Viewer Basics

### Access
```bash
eventvwr.msc
or via **Start â†’ Run â†’ "eventvwr"**
```
### Common Actions
- **Filter Current Log:** Limit by Event ID, Source, or Date
- **Create Custom Views:** Combine multiple log sources
- **Attach Tasks to Events:** Trigger actions or alerts
- **Export Logs:** Save as `.evtx` or `.csv` for analysis
---

## Security Log (Audit Log)

| Event ID | Description                     |
| -------- | ------------------------------- |
| **4624** | Successful logon                |
| **4625** | Failed logon attempt            |
| **4634** | Logoff event                    |
| **4648** | Logon with explicit credentials |
| **4672** | Admin privileges assigned       |
| **4720** | User account created            |
| **4722** | User account enabled            |
| **4723** | Password change attempt         |
| **4725** | User account disabled           |
| **4732** | User added to a group           |
| **1102** | Audit log cleared               |
secpol.msc

**Main Sections:**

| Category                                    | Description                              |
| ------------------------------------------- | ---------------------------------------- |
| **Account Policies**                        | Password & lockout policies              |
| **Local Policies**                          | Audit, user rights, and security options |
| **Windows Firewall with Advanced Security** | Inbound/outbound rules                   |
| **Advanced Audit Policy Configuration**     | Fine-grained control over auditing       |

```
gpedit.msc
# Path: Computer Configuration â†’ Windows Settings â†’ Security Settings â†’ Local Policies â†’ Audit Policy
```

**Key Audit Categories:**

| Policy                             | Description                                    |
| ---------------------------------- | ---------------------------------------------- |
| **Audit account logon events**     | Tracks authentication on domain controllers    |
| **Audit logon events**             | Tracks local and network logons                |
| **Audit object access**            | Tracks access to specific files/folders        |
| **Audit policy change**            | Monitors audit and user rights modifications   |
| **Audit privilege use**            | Detects sensitive privilege actions            |
| **Audit system events**            | Tracks system restarts, shutdowns, or crashes  |
| **Audit directory service access** | Monitors AD object access (domain controllers) |

## Useful PowerShell Commands
```
# View last 20 Security log entries
Get-EventLog -LogName Security -Newest 20

# Filter specific Event ID
Get-EventLog -LogName Security | Where-Object {$_.EventID -eq 4625}

# Export logs
wevtutil epl Security C:\Logs\Security.evtx

# Clear logs (Admin only)
wevtutil cl Security
```


## Example: Detecting Failed Logons
```
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4625} |
Select-Object TimeCreated, @{Name='Account'; Expression={$_.Properties[5].Value}}
```
**Use this to identify repeated login failures from the same source IP or username.**

## Example: Basic Security Audit Configuration
```
# Enable logon and privilege use auditing
auditpol /set /category:"Logon/Logoff" /success:enable /failure:enable
auditpol /set /subcategory:"Privilege Use" /success:enable /failure:enable
```

[!]**Tip:** Combine **Event Viewer** and **Audit Policy** data with a SIEM for comprehensive visibility and correlation across endpoints[!]

