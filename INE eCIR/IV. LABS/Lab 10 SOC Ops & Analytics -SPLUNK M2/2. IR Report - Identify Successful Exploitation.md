# Vulnerability Finding: Cerber Ransomware Infection Detection

**Endpoint:** `192.168.250.100 – Wayne Enterprises`  
**Date Identified:** 04/10/2025  
**Investigator:** Mr. Yassine SAHLI  

---

## Description

During proactive threat hunting in Splunk on the monitored network segment, unusual DNS queries were detected from host **192.168.250.100**, targeting the suspicious domain **cerberhhyed5frqa.xmfir0.win**. Analysis of Windows Sysmon logs revealed abnormal process execution patterns on the endpoint, suggesting **a ransomware infection, specifically Cerber ransomware**.

Key observations include:

- DNS queries to **DGA-generated domains** indicating possible C2 communications.  
- High-frequency process execution spikes involving **`osk.exe`**, an on-screen keyboard executable residing in an atypical directory (`C:\Users\<user>\AppData\Roaming\`), suggestive of malicious impersonation.  
- Sequential execution chain observed:  

==``wscript.exe (Parent)
   ``└── cmd.exe (Child)
         ``└── 121214.tmp
               ``└── 20429.vbs (obfuscated script)==

- Obfuscated scripts executing under the user **Bob Smith**, confirming compromise and ransomware activity.  
- MD5 hash `EE0828A4E4C195D97313BFC7D4B531F1` correlates with **Cerber ransomware** indicators.  

---

## Impact

- **Data Encryption:** Potential encryption of local and network-accessible files, leading to operational disruption.  
- **Endpoint Compromise:** Host 192.168.250.100 is fully compromised and could serve as a pivot to internal systems.  
- **C2 Communication:** Host attempting to contact external DGA domains may leak sensitive information or facilitate additional malware downloads.  
- **Medium to High Risk:** The ransomware infection can quickly escalate, especially in a corporate environment with shared drives.

---

## Evidence

1. **Suspicious DNS Queries (DGA domain detection)**  
``cerberhhyed5frqa.xmfir0.win
![[Pasted image 20251004171232.png]]
![[Pasted image 20251004171348.png]]  

2. **Abnormal Sysmon Process Execution – `osk.exe` spikes**  
![[Pasted image 20251004174417.png]]  

3. **Process Execution Chain indicating obfuscated scripts**  
==wscript.exe → cmd.exe → 121214.tmp → 20429.vbs

![[Pasted image 20251004191823.png]]  

4. **MD5 Hash Identification for Cerber Ransomware**  
``EE0828A4E4C195D97313BFC7D4B531F1
![[Pasted image 20251004195122.png]]  

---

## MITRE ATT&CK Mapping

- **Execution**  
  - **T1059 – Command and Scripting Interpreter**: Execution of scripts (wscript, cmd) to deploy malware.  
- **Persistence**  
  - **T1053 – Scheduled Task/Job**: Likely executed scripts to maintain persistence.  
- **Defense Evasion**  
  - **T1140 – Deobfuscate/Decode Files or Information**: Use of obfuscated VBS scripts to bypass detection.  
- **Impact**  
  - **T1486 – Data Encrypted for Impact**: Cerber ransomware encrypts files to disrupt operations.  
- **Command and Control**  
  - **T1496 – Domain Generation Algorithms**: Contacting dynamically generated domains for C2 communication.

---

## Recommendation

**Immediate Response:**  
- Isolate the infected host **192.168.250.100** from the network.  
- Capture volatile memory and network traffic for forensic analysis.  
- Notify incident response and cybersecurity teams to halt spread.  

**Remediation:**  
- Remove malicious scripts and ransomware binaries from affected endpoints.  
- Restore files from verified backups to prevent data loss.  
- Apply endpoint detection and response (EDR) rules to detect obfuscated script execution.  

**Preventive Measures:**  
- Implement DNS filtering and DGA detection to block malicious domains.  
- Enforce strict application whitelisting to prevent unauthorized script execution.  
- Regularly update endpoint antivirus and deploy advanced behavioral detection solutions.  

**Monitoring:**  
- Continuously monitor Splunk for repeated patterns of suspicious DNS queries and abnormal process executions.  
- Configure alerts for obfuscated script execution chains and unusual MD5 hashes.  

---

**Severity:** High  
**CVSSv3.1 Score:** 8.2 – Ransomware infection with potential network-wide impact, including data encryption and operational disruption.  
